[tox]
envlist = py39, py310, py311, py312, lint, type-check, docs, security
isolated_build = True

[testenv]
deps =
    pytest>=7.0
    pytest-cov>=4.0
    pytest-benchmark>=4.0
    nistrng>=0.1.0
extras = test,crypto
commands =
    pytest tests/ -v --cov=chaos_rng --cov-report=xml --cov-report=html

[testenv:lint]
deps =
    black>=22.0
    ruff>=0.1.0
    isort>=5.10
commands =
    ruff check src/ tests/
    black --check src/ tests/
    isort --check-only src/ tests/

[testenv:type-check]
deps =
    mypy>=1.0
    types-setuptools
commands =
    mypy src/

[testenv:docs]
deps =
    sphinx>=5.0
    sphinx-rtd-theme>=1.0
    numpydoc>=1.4
extras = docs
commands =
    sphinx-build -W -b html docs docs/_build/html

[testenv:security]
deps =
    bandit>=1.7.0
    safety>=2.0
commands =
    bandit -r src/
    safety check

[testenv:statistical]
deps =
    pytest>=7.0
    nistrng>=0.1.0
extras = test,crypto
commands =
    pytest tests/ -v -m statistical --tb=short

[testenv:benchmark]
deps =
    pytest>=7.0
    pytest-benchmark>=4.0
extras = test,crypto
commands =
    pytest tests/ -k benchmark --benchmark-only

[testenv:clean]
deps = coverage
commands = coverage erase

[coverage:run]
source = src
branch = True
parallel = True

[coverage:report]
exclude_lines =
    pragma: no cover
    def __repr__
    if self.debug:
    if settings.DEBUG
    raise AssertionError
    raise NotImplementedError
    if 0:
    if __name__ == .__main__.:
    class .*\bProtocol\):
    @(abc\.)?abstractmethod

[coverage:html]
directory = htmlcov

[coverage:xml]
output = coverage.xml
